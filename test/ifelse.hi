Vec4 :: Float -> Float -> Float -> Float -> Vec4 
Vec2 :: Float -> Float -> Vec2
-- Get :: Vec4 -> Int -> Float
extract_0 :: Vec2 ->  Float
extract_1 :: Vec2 ->  Float

add :: Float -> Float -> Float
add a b = a + b;

sub :: Float -> Float -> Float
sub a b = add a (-b);

const_if :: Bool -> Float
const_if a = if a then 2.0 else 3.0;

var_if :: Bool -> Float -> Float
var_if c a = if c then a else -a;

max :: Float -> Float -> Float
max a b = if a > b then a else b;

main :: Vec2 -> Vec4
main uv = 
    let 
        x = extract_0 uv;
        y = extract_1 uv;

        d = if (x > y) then
                if (x > 0.5) then
                    add
                else
                    sub
        else
            sub;

        t1 = const_if True;
        t2 = var_if (x > 0.5) 0.5;
        t3 = max t1 t2;

        d1 = d x;
        d2 = d1 t3;

    in
        Vec4 x y d2 1.0;
